{% extends 'base.html' %}

{% block title %}Configuración de Cuenta | VeriHome{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-3xl mx-auto">
        <h1 class="text-2xl font-bold text-gray-800 mb-6">Configuración de Cuenta</h1>
        
        <!-- Navegación de configuración -->
        <div class="bg-white rounded-lg shadow-md mb-6">
            <div class="border-b border-gray-200">
                <nav class="flex -mb-px">
                    <a href="#profile" class="tab-link active border-b-2 border-primary-500 py-4 px-6 text-sm font-medium text-primary-600">
                        Perfil
                    </a>
                    <a href="#security" class="tab-link border-b-2 border-transparent py-4 px-6 text-sm font-medium text-gray-500 hover:text-gray-700">
                        Seguridad
                    </a>
                    <a href="#notifications" class="tab-link border-b-2 border-transparent py-4 px-6 text-sm font-medium text-gray-500 hover:text-gray-700">
                        Notificaciones
                    </a>
                    <a href="#privacy" class="tab-link border-b-2 border-transparent py-4 px-6 text-sm font-medium text-gray-500 hover:text-gray-700">
                        Privacidad
                    </a>
                </nav>
            </div>
        </div>
        
        <!-- Contenido de las pestañas -->
        <div class="tab-content" id="profile">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Información Personal</h2>
                
                <form method="post" action="{% url 'users:profile_edit' %}" class="space-y-4">
                    {% csrf_token %}
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="first_name" class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
                            <input type="text" name="first_name" id="first_name" value="{{ user.first_name }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="last_name" class="block text-sm font-medium text-gray-700 mb-1">Apellido</label>
                            <input type="text" name="last_name" id="last_name" value="{{ user.last_name }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo electrónico</label>
                            <input type="email" name="email" id="email" value="{{ user.email }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500" disabled>
                            <p class="mt-1 text-xs text-gray-500">Para cambiar tu correo electrónico, contacta a soporte.</p>
                        </div>
                        <div>
                            <label for="phone_number" class="block text-sm font-medium text-gray-700 mb-1">Teléfono</label>
                            <input type="tel" name="phone_number" id="phone_number" value="{{ user.phone_number }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Información de Contacto</h2>
                
                <form method="post" action="{% url 'users:profile_edit' %}" class="space-y-4">
                    {% csrf_token %}
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="address" class="block text-sm font-medium text-gray-700 mb-1">Dirección</label>
                            <input type="text" name="address" id="address" value="{{ profile.address }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="city" class="block text-sm font-medium text-gray-700 mb-1">Ciudad</label>
                            <input type="text" name="city" id="city" value="{{ profile.city }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="state" class="block text-sm font-medium text-gray-700 mb-1">Estado/Provincia</label>
                            <input type="text" name="state" id="state" value="{{ profile.state }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="postal_code" class="block text-sm font-medium text-gray-700 mb-1">Código postal</label>
                            <input type="text" name="postal_code" id="postal_code" value="{{ profile.postal_code }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                        <div>
                            <label for="country" class="block text-sm font-medium text-gray-700 mb-1">País</label>
                            <input type="text" name="country" id="country" value="{{ profile.country }}" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                        </div>
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="tab-content hidden" id="security">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Cambiar Contraseña</h2>
                
                <form method="post" action="{% url 'account_change_password' %}" class="space-y-4">
                    {% csrf_token %}
                    
                    <div>
                        <label for="oldpassword" class="block text-sm font-medium text-gray-700 mb-1">Contraseña actual</label>
                        <input type="password" name="oldpassword" id="oldpassword" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div>
                        <label for="password1" class="block text-sm font-medium text-gray-700 mb-1">Nueva contraseña</label>
                        <input type="password" name="password1" id="password1" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div>
                        <label for="password2" class="block text-sm font-medium text-gray-700 mb-1">Confirmar nueva contraseña</label>
                        <input type="password" name="password2" id="password2" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Cambiar Contraseña
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Sesiones Activas</h2>
                
                <div class="border-t border-gray-200 pt-4">
                    <div class="flex items-center justify-between py-3">
                        <div>
                            <p class="text-sm font-medium text-gray-900">Sesión actual</p>
                            <p class="text-xs text-gray-500">Iniciada el {{ user.last_login|date:"d/m/Y H:i" }}</p>
                        </div>
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                            Activa
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content hidden" id="notifications">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Preferencias de Notificaciones</h2>
                
                <form method="post" action="#" class="space-y-4">
                    {% csrf_token %}
                    
                    <div class="space-y-3">
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="email_notifications" name="email_notifications" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="email_notifications" class="font-medium text-gray-700">Notificaciones por correo electrónico</label>
                                <p class="text-gray-500">Recibe notificaciones importantes por correo electrónico.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="message_notifications" name="message_notifications" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="message_notifications" class="font-medium text-gray-700">Notificaciones de mensajes</label>
                                <p class="text-gray-500">Recibe notificaciones cuando recibas nuevos mensajes.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="contract_notifications" name="contract_notifications" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="contract_notifications" class="font-medium text-gray-700">Notificaciones de contratos</label>
                                <p class="text-gray-500">Recibe notificaciones sobre tus contratos.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="payment_notifications" name="payment_notifications" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="payment_notifications" class="font-medium text-gray-700">Notificaciones de pagos</label>
                                <p class="text-gray-500">Recibe notificaciones sobre pagos y transacciones.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Guardar Preferencias
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="tab-content hidden" id="privacy">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Configuración de Privacidad</h2>
                
                <form method="post" action="#" class="space-y-4">
                    {% csrf_token %}
                    
                    <div class="space-y-3">
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="profile_public" name="profile_public" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded" checked>
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="profile_public" class="font-medium text-gray-700">Perfil público</label>
                                <p class="text-gray-500">Permite que otros usuarios vean tu perfil.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="show_email" name="show_email" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="show_email" class="font-medium text-gray-700">Mostrar correo electrónico</label>
                                <p class="text-gray-500">Permite que otros usuarios vean tu correo electrónico.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="show_phone" name="show_phone" type="checkbox" class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="show_phone" class="font-medium text-gray-700">Mostrar teléfono</label>
                                <p class="text-gray-500">Permite que otros usuarios vean tu número de teléfono.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pt-4">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Guardar Preferencias
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Eliminar Cuenta</h2>
                
                <p class="text-gray-500 mb-4">Esta acción es permanente y no se puede deshacer. Se eliminarán todos tus datos.</p>
                
                <button type="button" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                    Eliminar mi cuenta
                </button>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabLinks = document.querySelectorAll('.tab-link');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Función para cambiar de pestaña
        function switchTab(tabId) {
            // Ocultar todos los contenidos
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // Mostrar el contenido seleccionado
            document.getElementById(tabId).classList.remove('hidden');
            
            // Actualizar clases de los enlaces
            tabLinks.forEach(link => {
                link.classList.remove('border-primary-500', 'text-primary-600');
                link.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Activar el enlace seleccionado
            document.querySelector(`a[href="#${tabId}"]`).classList.remove('border-transparent', 'text-gray-500');
            document.querySelector(`a[href="#${tabId}"]`).classList.add('border-primary-500', 'text-primary-600');
        }
        
        // Manejar clics en las pestañas
        tabLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabId = this.getAttribute('href').substring(1);
                switchTab(tabId);
                
                // Actualizar URL con hash
                window.location.hash = tabId;
            });
        });
        
        // Verificar si hay un hash en la URL
        if (window.location.hash) {
            const tabId = window.location.hash.substring(1);
            switchTab(tabId);
        }
    });
</script>
{% endblock %}
{% endblock %}