{% extends "base.html" %}

{% load i18n %}
{% load account socialaccount %}

{% block title %}{% trans "Iniciar Sesión" %} | VeriHome{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12">
  <div class="max-w-md mx-auto px-4 sm:px-6 lg:px-8">
    <div class="bg-white rounded-2xl shadow-elegant p-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <div class="w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
          </svg>
        </div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">{% trans "Iniciar Sesión" %}</h1>
        <p class="text-gray-600">Accede a tu cuenta de VeriHome</p>
      </div>

      <!-- Formulario de inicio de sesión -->
      <form class="login space-y-6" method="POST" action="{% url 'account_login' %}">
        {% csrf_token %}
        
        {% if form.errors %}
        <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4">
          <p class="font-medium">Por favor corrige los siguientes errores:</p>
          <ul class="list-disc pl-5 mt-2">
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
        
        <!-- Campo de correo electrónico -->
        <div>
          <label for="id_login" class="block text-sm font-medium text-gray-700 mb-2">{% trans "Correo Electrónico" %}</label>
          <input type="email" name="login" id="id_login" placeholder="tu@correo.com" required
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200">
        </div>
        
        <!-- Campo de contraseña -->
        <div>
          <div class="flex items-center justify-between mb-2">
            <label for="id_password" class="block text-sm font-medium text-gray-700">{% trans "Contraseña" %}</label>
            <a href="{% url 'account_reset_password' %}" class="text-sm text-primary-600 hover:text-primary-700 font-medium">
              {% trans "¿Olvidaste tu contraseña?" %}
            </a>
          </div>
          <input type="password" name="password" id="id_password" placeholder="••••••••" required
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200">
        </div>
        
        <!-- Recordarme -->
        <div class="flex items-center">
          <input type="checkbox" name="remember" id="id_remember" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
          <label for="id_remember" class="ml-3 text-sm text-gray-700">
            {% trans "Recordarme" %}
          </label>
        </div>
        
        {% if redirect_field_value %}
        <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
        {% endif %}
        
        <!-- Botón de inicio de sesión -->
        <button type="submit" class="w-full bg-primary-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary-700 transition-colors duration-200">
          {% trans "Iniciar Sesión" %}
        </button>
      </form>

      <!-- Enlaces adicionales -->
      <div class="text-center mt-8 pt-6 border-t border-gray-200">
        <p class="text-gray-600 mb-4">
          {% trans "¿No tienes una cuenta?" %}
          <a href="{% url 'users:register_select' %}" class="text-primary-600 hover:text-primary-700 font-medium">
            {% trans "Regístrate" %}
          </a>
        </p>
        
        {% get_providers as socialaccount_providers %}
        {% if socialaccount_providers %}
        <div class="mt-6">
          <p class="text-sm text-gray-500 mb-4">{% trans "O inicia sesión con:" %}</p>
          <div class="flex justify-center space-x-4">
            {% for provider in socialaccount_providers %}
            <a href="{% provider_login_url provider.id process='login' %}" 
               class="flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200">
              {% if provider.name == 'Google' %}
              <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"/>
              </svg>
              {% endif %}
              {{ provider.name }}
            </a>
            {% endfor %}
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}